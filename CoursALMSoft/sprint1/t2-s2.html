<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html lang="en-US">  <head>    <meta http-equiv="content-type" content="text/html; charset=utf-8">    <title>Workshop: Programming Basics</title>    <meta name="CHANGEDBY" content="Pr. Olivier Gruber">    <link rel="stylesheet" href="../style.css" type="text/css">    <script src="../common.js"></script>    <link rel="stylesheet" href="../highlight.js/styles/default.css">    <script src="../highlight.js/highlight.pack.js"></script>    <script>hljs.initHighlightingOnLoad();</script>  </head>  <body onload="shellOnLoad()">    <script>      function shellOnLoad() {        multiLang();        /*hljs.initHighlightingOnLoad(); */      }      </script>    <div id="outer-container">      <div id="header">        <div id="logo"> <img src="../logo_uga.png" alt="Université Grenoble-Alpes"            border="0"            height="100">          <img src="../logo_reseau_polytech.gif" alt="Polytech" border="0" height="80">        </div>        <div id="top-links"> <a href="../index.html">Home</a> </div>      </div>      <div id="inner-container">        <h1>Bases du langage C<br>        </h1>        <h2>Task2 -- Une première fonction</h2>        <h3>Step2 -- Définition et utilisation d'une fonction (C)<br>        </h3>        <h3>Définir une fonction</h3>        <p>Comme nous l'avons vu en assembleur ARM, il est possible en C de          réutiliser du          code en l'encapsulant dans une fonction. Le concept de fonction en C          est le même :          une fonction prend un certain nombre de valeurs d'entrées, et retourne          une          valeur de sortie.        </p>        <p>          Une fonction en C est définie de la manière suivante:</p>        <pre><code class="c">int nom_fonction(int a, int b, char c){    int resultat;    /*       ....       Corps de la fonction       ....    */    return resultat;}</code></pre>        <p>          Le premier <i><b>int</b></i> correspond au type de la valeur de          retour, ici un entier.          Si la fonction ne retourne aucune valeur, le type sera <i><b>void</b></i>.        </p>        <p>          Vient ensuite le nom de la fonction, et la liste de ses paramètres          d'entrée.          Ces paramètres sont des variables accessibles <b>uniquement</b> dans          le corps de          la fonction (entre les accolades).        </p>        <p>          Entre les accolades, on retrouve:        </p>        <ul>          <li> Des déclarations de variable locales. Dans cet exemple la            fonction déclare une variable <i>resultat</i> de type <i>int</i> </li>          <li>Le corps de la fonction, l'ensemble des instructions qui seront            executées chaque fois que la fonction est appelée. </li>          <li> Dans le cas où la fonction retourne un résultat, (type différent            de <i>void</i>) l'instruction <i><b>return</b></i> permet de            retourner une valeur (par exemple le contenu d'une variable). Dans            cette exemple la valeur de la variable locale <i>resultat</i> est            retournée. </li>        </ul>        <p></p>        <p>        </p>        Voici un exemple de fonction, prenant en paramètre un entier <i><b>int</b></i>        et        retournant un entier correspondant au carré de la valeur d'entrée        <pre><code class="c">int square(int a){    int res;    res = a * a;    return res;}</code></pre>        <h3>Appeler une fonction</h3>        <p>          Pour appeler une fonction, à partir du <i><b>main</b></i> ou d'une          autre fonction, on utilise          la syntaxe suivante:        </p>        <pre><code class="c">x = fonction(a, b, 3);</code></pre>        <p>          Ici on appel la fonction        </p>        <pre><code class="c"> int fonction(int x, int y, int z)</code></pre>        <p>          en donnant en paramètre la <b>valeur</b> des variables          a et b et la valeur constante 3. Le nombre et le type des paramètres          doit correspondre à la déclaration de la fonction. On ne peut pas          appeler une fonction prenant deux paramètres en ne lui en fournissant          qu'un          seul.<br>          Par exemple, les appels suivants sont incorrects.        </p>        <pre><code class="c">fonction("HELLO", 'a', 23);fonction(3, 14);</code></pre>        <p>Les paramètres passés au moment de l'appel (<i><b>effectifs</b></i>)          de la          fonction doivent être des valeurs de même type que ceux de la          déclaration.<br>          Un paramètre effectif peut être le contenu d'une variable          (en donnant son nom), une valeur explicite (42)... <br>          Ces valeurs sont copiées          dans les variables "paramètres".          C'est à dire que si la fonction modifie la valeur d'un paramètre, la          variable passée en paramètre effectif n'est pas modifiée.<br>        </p>        <p>          Voici un exemple illustrant une fonction modifiant son paramètre          d'entrée        </p>        <pre><code class="c">int square(int a){    a = a * a;    return a;}int main(void){    int quatre = 4;    int res;    res = square(quatre);    /*        res = 16        quatre = 4    */    return res;}</code></pre>        <p>          La fonction <i>square</i> a modifié son paramètre <i>a</i>,          pourtant, la          variable <i>quatre</i> donnée en entrée n'a pas vu sa valeur          modifiée. Sa valeur          a été <b>copiée</b> dans la variable <i>a</i>.        </p>        <h3>Observations avec gdb</h3>        <p>Placez vous dans le répertoire <b>task2s2C</b>. <br>        </p>        <p>En utilisant gdb, observez les valeurs des variables <i><b>quatre</b></i>,          <i><b>res</b></i> et <i><b>a</b></i> au cours          de l'exécution, en particulier aux checkpoints ajoutés dans le C. <br>          N'oubliez pas d'utiliser <i>layout next</i> pour changer de mode de          visualisation.<br>          La commande <i>display</i> pourrait vous être utile également. Elle          permet de          suivre le contenu d'une variable à chaque étape de l'exécution.        </p>        <h3>Programmation modulaire</h3>        <h4>Prototype de fonction</h4>        <p>          Nous allons maintenant voir comment bien structurer nos programmes.          Une fonction est accessible si elle est visible par la fonction          appelante. Pour          que ce soit le cas, il y a deux possibilités : <br>          1) La fonction a été définie plus          haut dans le programme, comme c'est le cas pour la fonction <b>square</b>.          <br>          2) La fonction est définie plus bas ou dans un fichier séparé. Dans ce          cas, la          fonction doit être <b>déclarée</b>.        </p>        <p>Une déclaration de fonction est identique à l'en-tête d'une fonction,          sans le          corps. On appelle cela le <b>prototype</b> de la fonction.        </p>        <pre><code class="c">int square(int a);</code></pre>        <p>          Dans le fichier <b>main.c</b>, déplacez la fonction <i>square</i>          après la          fonction main.<br>          Essayez de recompiler le programme, que signifie le message d'erreur ?        </p>        <p>          Pour résoudre le problème, ajoutez le prototype de la fonction avant          la fonction          main. Le problème est-il résolu ?        </p>        <h4>Compilation séparée</h4>        <p>          Pour mieux organiser des programmes volumineux, il est possible de          placer les          fonctions dans des fichiers séparés.<br>          Créez un fichier <i><b>square.c</b></i> et déplacez la fonction <i>square</i>          dans ce          fichier.        </p>        <p>          Essayez de compiler à nouveau. Que signifie le message d'erreur ?        </p>        <p>          Modifiez le <i>Makefile</i> pour compiler le fichier <i><span style="font-weight: bold;">square.c</span></i>          et l'ajouter au          processus de compilation de l'exécutable binaire.<br>          Vous devez :<br>          1) Ajouter une règle pour générer le fichier <i><span style="font-weight: bold;">square.o</span></i><br>          2) Ajouter le fichier <i><span style="font-weight: bold;">square.o</span></i>          à l'édition de lien (<i>ld</i>)<br>          3) Ajouter la dépendance <i><span style="font-weight: bold;">square.o</span></i>          à la règle <i><span style="font-weight: bold;">kernel.bin</span></i><br>        </p>        <h4>Exercices de programmation</h4>        <code class="c"></code><code class="c"></code>        <pre></pre>        <p></p>        <p>          <b>Exercice 1 :</b>Écrivez une fonction prenant en entrée trois          paramètres entiers (<i>int)</i> et          retournant le plus grand des trois. Vous pouvez tester votre fonction          en          utilisant le fichier <i>main.c</i> du répertoire task2s2C.        </p>        <p>          <b>Exercice 2 :</b> Écrivez une fonction qui          prend en entrée deux paramètres entiers <i><b>a</b></i> et <i><b>b</b></i>,          et retourne <i><b>a<sup>b</sup></b></i>.        </p>        <p>          <b>Exercice 3 :</b> Écrivez <b>sans utiliser de boucle</b> une          fonction qui          prend en entrée deux entiers <i><b>a</b></i> et <b><i>b</i></b>, et          retourne <i><b>a<sup>b</sup></b></i>.        </p>        <div id="footer"> © UFR IM2AG<br>          <div id="bottom-links" style="float: right;"> <a href="../index.html">Home</a>          </div>        </div>      </div>    </div>  </body></html>